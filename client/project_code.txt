

‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./components/ui/select.tsx
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

"use client"

import * as React from "react"
import * as SelectPrimitive from "@radix-ui/react-select"
import { CheckIcon, ChevronDownIcon, ChevronUpIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function Select({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Root>) {
  return <SelectPrimitive.Root data-slot="select" {...props} />
}

function SelectGroup({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Group>) {
  return <SelectPrimitive.Group data-slot="select-group" {...props} />
}

function SelectValue({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Value>) {
  return <SelectPrimitive.Value data-slot="select-value" {...props} />
}

function SelectTrigger({
  className,
  size = "default",
  children,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Trigger> & {
  size?: "sm" | "default"
}) {
  return (
    <SelectPrimitive.Trigger
      data-slot="select-trigger"
      data-size={size}
      className={cn(
        "border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    >
      {children}
      <SelectPrimitive.Icon asChild>
        <ChevronDownIcon className="size-4 opacity-50" />
      </SelectPrimitive.Icon>
    </SelectPrimitive.Trigger>
  )
}

function SelectContent({
  className,
  children,
  position = "popper",
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Content>) {
  return (
    <SelectPrimitive.Portal>
      <SelectPrimitive.Content
        data-slot="select-content"
        className={cn(
          "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",
          position === "popper" &&
            "data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",
          className
        )}
        position={position}
        {...props}
      >
        <SelectScrollUpButton />
        <SelectPrimitive.Viewport
          className={cn(
            "p-1",
            position === "popper" &&
              "h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"
          )}
        >
          {children}
        </SelectPrimitive.Viewport>
        <SelectScrollDownButton />
      </SelectPrimitive.Content>
    </SelectPrimitive.Portal>
  )
}

function SelectLabel({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Label>) {
  return (
    <SelectPrimitive.Label
      data-slot="select-label"
      className={cn("text-muted-foreground px-2 py-1.5 text-xs", className)}
      {...props}
    />
  )
}

function SelectItem({
  className,
  children,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Item>) {
  return (
    <SelectPrimitive.Item
      data-slot="select-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",
        className
      )}
      {...props}
    >
      <span className="absolute right-2 flex size-3.5 items-center justify-center">
        <SelectPrimitive.ItemIndicator>
          <CheckIcon className="size-4" />
        </SelectPrimitive.ItemIndicator>
      </span>
      <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
    </SelectPrimitive.Item>
  )
}

function SelectSeparator({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Separator>) {
  return (
    <SelectPrimitive.Separator
      data-slot="select-separator"
      className={cn("bg-border pointer-events-none -mx-1 my-1 h-px", className)}
      {...props}
    />
  )
}

function SelectScrollUpButton({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.ScrollUpButton>) {
  return (
    <SelectPrimitive.ScrollUpButton
      data-slot="select-scroll-up-button"
      className={cn(
        "flex cursor-default items-center justify-center py-1",
        className
      )}
      {...props}
    >
      <ChevronUpIcon className="size-4" />
    </SelectPrimitive.ScrollUpButton>
  )
}

function SelectScrollDownButton({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.ScrollDownButton>) {
  return (
    <SelectPrimitive.ScrollDownButton
      data-slot="select-scroll-down-button"
      className={cn(
        "flex cursor-default items-center justify-center py-1",
        className
      )}
      {...props}
    >
      <ChevronDownIcon className="size-4" />
    </SelectPrimitive.ScrollDownButton>
  )
}

export {
  Select,
  SelectContent,
  SelectGroup,
  SelectItem,
  SelectLabel,
  SelectScrollDownButton,
  SelectScrollUpButton,
  SelectSeparator,
  SelectTrigger,
  SelectValue,
}



‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./components/ui/separator.tsx
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

"use client"

import * as React from "react"
import * as SeparatorPrimitive from "@radix-ui/react-separator"

import { cn } from "@/lib/utils"

function Separator({
  className,
  orientation = "horizontal",
  decorative = true,
  ...props
}: React.ComponentProps<typeof SeparatorPrimitive.Root>) {
  return (
    <SeparatorPrimitive.Root
      data-slot="separator"
      decorative={decorative}
      orientation={orientation}
      className={cn(
        "bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",
        className
      )}
      {...props}
    />
  )
}

export { Separator }



‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./components/ui/sheet.tsx
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

"use client"

import * as React from "react"
import * as SheetPrimitive from "@radix-ui/react-dialog"
import { cva, type VariantProps } from "class-variance-authority"
import { X } from "lucide-react"

import { cn } from "@/lib/utils"

const Sheet = SheetPrimitive.Root

const SheetTrigger = SheetPrimitive.Trigger

const SheetClose = SheetPrimitive.Close

const SheetPortal = SheetPrimitive.Portal

const SheetOverlay = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Overlay
    className={cn(
      "fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className
    )}
    {...props}
    ref={ref}
  />
))
SheetOverlay.displayName = SheetPrimitive.Overlay.displayName

const sheetVariants = cva(
  "fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",
  {
    variants: {
      side: {
        top: "inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",
        bottom:
          "inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",
        left: "inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",
        right:
          "inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm",
      },
    },
    defaultVariants: {
      side: "right",
    },
  }
)

interface SheetContentProps
  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,
    VariantProps<typeof sheetVariants> {}

const SheetContent = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Content>,
  SheetContentProps
>(({ side = "right", className, children, ...props }, ref) => (
  <SheetPortal>
    <SheetOverlay />
    <SheetPrimitive.Content
      ref={ref}
      className={cn(sheetVariants({ side }), className)}
      {...props}
    >
      {children}
      <SheetPrimitive.Close className="absolute left-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </SheetPrimitive.Close>
    </SheetPrimitive.Content>
  </SheetPortal>
))
SheetContent.displayName = SheetPrimitive.Content.displayName

const SheetHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col space-y-2 text-center sm:text-left",
      className
    )}
    {...props}
  />
)
SheetHeader.displayName = "SheetHeader"

const SheetFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",
      className
    )}
    {...props}
  />
)
SheetFooter.displayName = "SheetFooter"

const SheetTitle = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Title
    ref={ref}
    className={cn("text-lg font-semibold text-foreground", className)}
    {...props}
  />
))
SheetTitle.displayName = SheetPrimitive.Title.displayName

const SheetDescription = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Description
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
))
SheetDescription.displayName = SheetPrimitive.Description.displayName

export {
  Sheet,
  SheetPortal,
  SheetOverlay,
  SheetTrigger,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetFooter,
  SheetTitle,
  SheetDescription,
}


‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./components/ui/switch.tsx
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

// FILE: components/ui/switch.tsx (RTL Fixed Version)
"use client"

import * as React from "react"
import * as SwitchPrimitives from "@radix-ui/react-switch"

import { cn } from "@/lib/utils"

const Switch = React.forwardRef<
  React.ElementRef<typeof SwitchPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>
>(({ className, ...props }, ref) => (
  <SwitchPrimitives.Root
    className={cn(
      "peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",
      className
    )}
    {...props}
    ref={ref}
  >
    <SwitchPrimitives.Thumb
      className={cn(
        "pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform",
        "data-[state=checked]:translate-x-5",
        "data-[state=unchecked]:translate-x-0",
        // FIX for RTL: We add rtl specific transform
        "rtl:data-[state=checked]:-translate-x-5",
        "rtl:data-[state=unchecked]:-translate-x-0"
      )}
    />
  </SwitchPrimitives.Root>
))
Switch.displayName = SwitchPrimitives.Root.displayName

export { Switch }



‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./components/ui/table.tsx
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

"use client"

import * as React from "react"

import { cn } from "@/lib/utils"

function Table({ className, ...props }: React.ComponentProps<"table">) {
  return (
    <div
      data-slot="table-container"
      className="relative w-full overflow-x-auto"
    >
      <table
        data-slot="table"
        className={cn("w-full caption-bottom text-sm", className)}
        {...props}
      />
    </div>
  )
}

function TableHeader({ className, ...props }: React.ComponentProps<"thead">) {
  return (
    <thead
      data-slot="table-header"
      className={cn("[&_tr]:border-b", className)}
      {...props}
    />
  )
}

function TableBody({ className, ...props }: React.ComponentProps<"tbody">) {
  return (
    <tbody
      data-slot="table-body"
      className={cn("[&_tr:last-child]:border-0", className)}
      {...props}
    />
  )
}

function TableFooter({ className, ...props }: React.ComponentProps<"tfoot">) {
  return (
    <tfoot
      data-slot="table-footer"
      className={cn(
        "bg-muted/50 border-t font-medium [&>tr]:last:border-b-0",
        className
      )}
      {...props}
    />
  )
}

function TableRow({ className, ...props }: React.ComponentProps<"tr">) {
  return (
    <tr
      data-slot="table-row"
      className={cn(
        "hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",
        className
      )}
      {...props}
    />
  )
}

function TableHead({ className, ...props }: React.ComponentProps<"th">) {
  return (
    <th
      data-slot="table-head"
      className={cn(
        "text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",
        className
      )}
      {...props}
    />
  )
}

function TableCell({ className, ...props }: React.ComponentProps<"td">) {
  return (
    <td
      data-slot="table-cell"
      className={cn(
        "p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",
        className
      )}
      {...props}
    />
  )
}

function TableCaption({
  className,
  ...props
}: React.ComponentProps<"caption">) {
  return (
    <caption
      data-slot="table-caption"
      className={cn("text-muted-foreground mt-4 text-sm", className)}
      {...props}
    />
  )
}

export {
  Table,
  TableHeader,
  TableBody,
  TableFooter,
  TableHead,
  TableRow,
  TableCell,
  TableCaption,
}



‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./components/ui/tabs.tsx
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

"use client"

import * as React from "react"
import * as TabsPrimitive from "@radix-ui/react-tabs"

import { cn } from "@/lib/utils"

function Tabs({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.Root>) {
  return (
    <TabsPrimitive.Root
      data-slot="tabs"
      className={cn("flex flex-col gap-2", className)}
      {...props}
    />
  )
}

function TabsList({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.List>) {
  return (
    <TabsPrimitive.List
      data-slot="tabs-list"
      className={cn(
        "bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",
        className
      )}
      {...props}
    />
  )
}

function TabsTrigger({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.Trigger>) {
  return (
    <TabsPrimitive.Trigger
      data-slot="tabs-trigger"
      className={cn(
        "data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    />
  )
}

function TabsContent({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.Content>) {
  return (
    <TabsPrimitive.Content
      data-slot="tabs-content"
      className={cn("flex-1 outline-none", className)}
      {...props}
    />
  )
}

export { Tabs, TabsList, TabsTrigger, TabsContent }



‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./components/ui/textarea.tsx
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

import * as React from "react"

import { cn } from "@/lib/utils"

function Textarea({ className, ...props }: React.ComponentProps<"textarea">) {
  return (
    <textarea
      data-slot="textarea"
      className={cn(
        "border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
        className
      )}
      {...props}
    />
  )
}

export { Textarea }



‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./context/AppContext.tsx
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

// FILE: context/AppContext.tsx (FIXED)
"use client";

import { createContext, useContext, useState, ReactNode, useEffect, useCallback } from "react";
import type { CartItem, User } from "@/types"; // <-- User ŸáŸÖ ÿßÿ≤ types Ÿàÿßÿ±ÿØ ÿ¥ÿØ
import type { Product as PrismaProduct } from "@prisma/client";
import apiClient from "@/lib/apiClient";

// ÿ™ÿπÿ±€åŸÅ ÿ≥ÿßÿÆÿ™ÿßÿ± ÿØÿßÿØŸá‚ÄåŸáÿß Ÿà ÿ™Ÿàÿßÿ®ÿπ ÿØÿ± Context
interface AppContextType {
    cart: CartItem[];
    addToCart: (product: PrismaProduct, quantity?: number) => void;
    updateCartQuantity: (productId: string, newQuantity: number) => void;
    removeFromCart: (productId: string) => void;
    clearCart: () => void;
    getTotalPrice: () => number;
    getOriginalTotalPrice: () => number;
    getTotalItems: () => number;

    user: User | null;
    setUser: (user: User | null) => void;
    login: (phone: string, password: string) => Promise<boolean>;
    logout: () => void;
    isLoadingUser: boolean;
    error: string | null;
}

const AppContext = createContext<AppContextType | undefined>(undefined);

export function AppProvider({ children }: { children: ReactNode }) {
    const [cart, setCart] = useState<CartItem[]>([]);
    const [user, setUser] = useState<User | null>(null);
    const [isLoadingUser, setIsLoadingUser] = useState(true);
    const [error, setError] = useState<string | null>(null);

    useEffect(() => {
        const checkUserSession = async () => {
            const token = localStorage.getItem('accessToken');
            if (!token) {
                setIsLoadingUser(false);
                return;
            }
            try {
                const response = await apiClient.get('/auth/user');
                setUser(response.data.user);
            } catch (e) {
                console.error("Session check failed, logging out.", e);
                setUser(null);
                localStorage.removeItem('accessToken');
                localStorage.removeItem('refreshToken');
            } finally {
                setIsLoadingUser(false);
            }
        };

        checkUserSession();
    }, []);


    const login = async (phone: string, password: string): Promise<boolean> => {
        setIsLoadingUser(true);
        setError(null);
        try {
            const response = await apiClient.post('/auth/login', { phone, password });
            const { user, accessToken, refreshToken } = response.data;
            localStorage.setItem('accessToken', accessToken);
            localStorage.setItem('refreshToken', refreshToken);
            setUser(user);
            return true;
        } catch (err: any) {
            setError(err.response?.data?.error || "ÿÆÿ∑ÿß€å Ÿàÿ±ŸàÿØ");
            return false;
        } finally {
            setIsLoadingUser(false);
        }
    };

    const logout = async () => {
        try {
            await apiClient.post('/auth/logout');
        } catch (e) {
            console.error("Logout API call failed, clearing local data anyway.", e);
        } finally {
            localStorage.removeItem('accessToken');
            localStorage.removeItem('refreshToken');
            setUser(null);
            setCart([]);
        }
    };

    const addToCart = (product: PrismaProduct, quantity = 1) => {
        setCart((prevCart) => {
            const existingItem = prevCart.find((item) => item.id === product.id);
            if (existingItem) {
                return prevCart.map((item) =>
                    item.id === product.id
                        ? { ...item, quantity: item.quantity + quantity }
                        : item
                );
            }
            return [...prevCart, { ...product, quantity }];
        });
    };

    const updateCartQuantity = (productId: string, newQuantity: number) => {
        if (newQuantity <= 0) {
            removeFromCart(productId);
            return;
        }
        setCart((prevCart) =>
            prevCart.map((item) =>
                item.id === productId ? { ...item, quantity: newQuantity } : item
            )
        );
    };

    const removeFromCart = (productId: string) => {
        setCart((prevCart) => prevCart.filter((item) => item.id !== productId));
    };

    const clearCart = () => {
        setCart([]);
    };

    const getOriginalTotalPrice = () => {
        return cart.reduce((total, item) => total + item.price * item.quantity, 0);
    }

    const getTotalPrice = () => {
        return cart.reduce((total, item) => {
            const discount = item.discountPercentage || 0;
            const discountedPrice = item.price * (1 - discount / 100);
            return total + discountedPrice * item.quantity;
        }, 0);
    };

    const getTotalItems = () => {
        return cart.reduce((total, item) => total + item.quantity, 0);
    };

    const value: AppContextType = {
        cart,
        addToCart,
        updateCartQuantity,
        removeFromCart,
        clearCart,
        getTotalPrice,
        getOriginalTotalPrice,
        getTotalItems,
        user,
        setUser,
        login,
        logout,
        isLoadingUser,
        error,
    };

    return <AppContext.Provider value={value}>{children}</AppContext.Provider>;
}

export function useAppContext() {
    const context = useContext(AppContext);
    if (context === undefined) {
        throw new Error("useAppContext must be used within an AppProvider");
    }
    return context;
}


‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./data/categories.ts
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

// FILE: data/categories.ts
export const categories = [
  { id: "sausage", name: "ÿ≥Ÿàÿ≥€åÿ≥ Ÿà ⁄©ÿßŸÑÿ®ÿßÿ≥", icon: "üå≠" },
  { id: "vegetables", name: "ÿ≥ÿ®ÿ≤€å ÿÆŸàÿ±ÿ¥ÿ™€å", icon: "ü•¨" },
  { id: "pickles", name: "ÿÆ€åÿßÿ±ÿ¥Ÿàÿ± Ÿà ÿ™ÿ±ÿ¥€å", icon: "ü•í" },
  { id: "mushrooms", name: "ŸÇÿßÿ±⁄Ü", icon: "üçÑ" },
  { id: "dairy", name: "ŸÑÿ®ŸÜ€åÿßÿ™", icon: "üßÄ" },
  { id: "rice", name: "ÿ®ÿ±ŸÜÿ¨ Ÿà ÿ≠ÿ®Ÿàÿ®ÿßÿ™", icon: "üåæ" },
]


‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./data/products.ts
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

// FILE: data/products.ts
import type { Product } from "@/types"

export const products: Product[] = [
  {
    id: 1,
    name: "ÿ≥Ÿàÿ≥€åÿ≥ ÿ¢ŸÑŸÖÿßŸÜ€å ÿØÿ±ÿ¨Ÿá €å⁄©",
    price: "€±,€≤€µ€∞,€∞€∞€∞",
    priceNumber: 1250000,
    image: "https://jamkharid.ir/uploads/products/500015.jpg?m=crop&w=500&h=500&q=high",
    category: "sausage",
    description: "ÿ≥Ÿàÿ≥€åÿ≥ ÿ¢ŸÑŸÖÿßŸÜ€å ÿ®ÿß ⁄©€åŸÅ€åÿ™ ÿ®ÿßŸÑÿß Ÿà ÿ∑ÿπŸÖ ÿπÿßŸÑ€å",
    ingredients: "⁄ØŸàÿ¥ÿ™ ⁄ØÿßŸàÿå ⁄ØŸàÿ¥ÿ™ ÿÆŸà⁄©ÿå ŸÜŸÖ⁄©ÿå ÿßÿØŸà€åŸá",
    storage: "ÿØÿ± €åÿÆ⁄ÜÿßŸÑ ŸÜ⁄ØŸáÿØÿßÿ±€å ÿ¥ŸàÿØ",
    available: true,
  },
  {
    id: 2,
    name: "ÿ≥ÿ®ÿ≤€å ÿÆŸàÿ±ÿ¥ÿ™ ŸÇŸàÿ±ŸÖŸá",
    price: "€∏€µ€∞,€∞€∞€∞",
    priceNumber: 850000,
    image: "https://sabziman.com/images/%D9%82%D9%88%D8%B1%D9%85%D9%87-%D8%AA%D9%87%D8%B1%D8%A7%D9%86%DB%8C-%D8%AE%D8%B1%D8%AF-%D8%B4%D8%AF%D9%87-1.jpg",
    category: "vegetables",
    description: "ÿ≥ÿ®ÿ≤€å ÿ™ÿßÿ≤Ÿá Ÿà Ÿæÿß⁄© ÿ¥ÿØŸá ÿ®ÿ±ÿß€å ÿÆŸàÿ±ÿ¥ÿ™ ŸÇŸàÿ±ŸÖŸá",
    ingredients: "ÿ¨ÿπŸÅÿ±€åÿå ÿ™ÿ±Ÿáÿå ÿ¥ŸÜÿ®ŸÑ€åŸÑŸá",
    storage: "ÿØÿ± €åÿÆ⁄ÜÿßŸÑ ŸÜ⁄ØŸáÿØÿßÿ±€å ÿ¥ŸàÿØ",
    available: true,
  },
  {
    id: 3,
    name: "ÿÆ€åÿßÿ±ÿ¥Ÿàÿ± ŸÖŸÖÿ™ÿßÿ≤",
    price: "€π€µ€∞,€∞€∞€∞",
    priceNumber: 950000,
    image: "https://bamomarket.com/images/1660901452322.jpg",
    category: "pickles",
    description: "ÿÆ€åÿßÿ±ÿ¥Ÿàÿ± ÿ™ÿ±ÿ¥ Ÿà ÿÆŸàÿ¥ŸÖÿ≤Ÿá",
    ingredients: "ÿÆ€åÿßÿ±ÿå ÿ≥ÿ±⁄©Ÿáÿå ŸÜŸÖ⁄©ÿå ÿßÿØŸà€åŸá",
    storage: "ÿØÿ± ÿØŸÖÿß€å ÿßÿ™ÿßŸÇ ŸÜ⁄ØŸáÿØÿßÿ±€å ÿ¥ŸàÿØ",
    available: true,
  },
  {
    id: 4,
    name: "ŸÇÿßÿ±⁄Ü ÿ®ÿ≥ÿ™Ÿá‚Äåÿß€å ÿ™ÿßÿ≤Ÿá",
    price: "€∑€µ€∞,€∞€∞€∞",
    priceNumber: 750000,
    image: "https://amirarsalanmushroom.com/wp-content/uploads/2023/04/%DB%B4%DB%B0%DB%B0-%DA%AF%D8%B1%D9%85%DB%8C-400x400.jpg",
    category: "mushrooms",
    description: "ŸÇÿßÿ±⁄Ü ÿ™ÿßÿ≤Ÿá Ÿà Ÿæÿß⁄© ÿ¥ÿØŸá",
    ingredients: "ŸÇÿßÿ±⁄Ü ÿ∑ÿ®€åÿπ€å",
    storage: "ÿØÿ± €åÿÆ⁄ÜÿßŸÑ ŸÜ⁄ØŸáÿØÿßÿ±€å ÿ¥ŸàÿØ",
    available: false,
  },
  {
    id: 5,
    name: "ŸæŸÜ€åÿ± Ÿæ€åÿ™ÿ≤ÿß ŸÖŸàÿ≤ÿßÿ±ŸÑÿß",
    price: "€≤,€±€∞€∞,€∞€∞€∞",
    priceNumber: 2100000,
    image: "https://img.beroozmart.com/unsafe/files/shop/product/661c44bfac8045bfb5fcfe380213a0a9.jpg",
    category: "dairy",
    description: "ŸæŸÜ€åÿ± ŸÖŸàÿ≤ÿßÿ±ŸÑÿß ŸÖÿÆÿµŸàÿµ Ÿæ€åÿ™ÿ≤ÿß",
    ingredients: "ÿ¥€åÿ±ÿå ŸÖÿß€åŸá ŸæŸÜ€åÿ±ÿå ŸÜŸÖ⁄©",
    storage: "ÿØÿ± €åÿÆ⁄ÜÿßŸÑ ŸÜ⁄ØŸáÿØÿßÿ±€å ÿ¥ŸàÿØ",
    available: true,
  },
  {
    id: 6,
    name: "ÿ®ÿ±ŸÜÿ¨ Ÿáÿßÿ¥ŸÖ€å ÿØÿ±ÿ¨Ÿá €å⁄©",
    price: "€≥,€≤€∞€∞,€∞€∞€∞",
    priceNumber: 3200000,
    image: "/placeholder.svg?height=120&width=120",
    category: "rice",
    description: "ÿ®ÿ±ŸÜÿ¨ Ÿáÿßÿ¥ŸÖ€å ÿπÿ∑ÿ±€å Ÿà ÿ®ÿß⁄©€åŸÅ€åÿ™",
    ingredients: "ÿ®ÿ±ŸÜÿ¨ Ÿáÿßÿ¥ŸÖ€å",
    storage: "ÿØÿ± ÿ¨ÿß€å ÿÆÿ¥⁄© ŸÜ⁄ØŸáÿØÿßÿ±€å ÿ¥ŸàÿØ",
    available: true,
  },
]


‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./hooks/useDebounce.ts
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

// FILE: client/hooks/useDebounce.ts (New File)
import { useState, useEffect } from 'react';

// This hook delays updating a value until a certain amount of time has passed without any new changes.
export default function useDebounce<T>(value: T, delay: number): T {
  const [debouncedValue, setDebouncedValue] = useState<T>(value);

  useEffect(() => {
    // Set a timer to update the debounced value after the specified delay
    const handler = setTimeout(() => {
      setDebouncedValue(value);
    }, delay);

    // Cleanup function: clear the timer if the value changes before the delay has passed
    return () => {
      clearTimeout(handler);
    };
  }, [value, delay]); // Only re-run the effect if value or delay changes

  return debouncedValue;
}


‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./lib/apiClient.ts
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

// FILE: client/lib/apiClient.ts
// DESCRIPTION: Centralized Axios instance for making API calls.
// It automatically attaches the access token and handles token refresh logic.

import axios from 'axios';
import Router from 'next/router';

// The base URL for all API requests
const baseURL = '/api';

const apiClient = axios.create({
  baseURL,
});

// --- Request Interceptor ---
// This runs BEFORE each request is sent.
apiClient.interceptors.request.use(
  (config) => {
    // 1. Get the access token from localStorage.
    const token = localStorage.getItem('accessToken');
    
    // 2. If the token exists, add it to the Authorization header.
    if (token) {
      config.headers['Authorization'] = `Bearer ${token}`;
    }
    return config;
  },
  (error) => {
    return Promise.reject(error);
  }
);

// --- Response Interceptor ---
// This runs AFTER a response is received.
let isRefreshing = false;
let failedQueue: { resolve: (token: string) => void, reject: (error: any) => void }[] = [];

const processQueue = (error: any, token: string | null = null) => {
  failedQueue.forEach(prom => {
    if (error) {
      prom.reject(error);
    } else {
      prom.resolve(token!);
    }
  });
  failedQueue = [];
};

apiClient.interceptors.response.use(
  (response) => {
    // If the request was successful, just return the response.
    return response;
  },
  async (error) => {
    const originalRequest = error.config;

    // 1. Check if the error is due to an expired token (status 403 from our middleware).
    if (error.response?.status === 403 && !originalRequest._retry) {
      if (isRefreshing) {
        // If a refresh is already in progress, queue the request.
        return new Promise(function(resolve, reject) {
          failedQueue.push({ resolve, reject });
        }).then(token => {
          originalRequest.headers['Authorization'] = 'Bearer ' + token;
          return axios(originalRequest);
        });
      }

      originalRequest._retry = true;
      isRefreshing = true;
      
      const refreshToken = localStorage.getItem('refreshToken');
      if (!refreshToken) {
        // If no refresh token, logout the user.
        // You might want to redirect to login page here.
        console.error("No refresh token available.");
        // Example: Router.push('/login');
        return Promise.reject(error);
      }
      
      try {
        // 2. Call the refresh token API endpoint.
        const { data } = await axios.post(`${baseURL}/auth/refresh`, { refreshToken });
        
        // 3. Update the stored access token.
        localStorage.setItem('accessToken', data.accessToken);
        
        // 4. Update the header of the original request and retry it.
        apiClient.defaults.headers.common['Authorization'] = 'Bearer ' + data.accessToken;
        originalRequest.headers['Authorization'] = 'Bearer ' + data.accessToken;
        processQueue(null, data.accessToken);
        
        return apiClient(originalRequest);

      } catch (refreshError) {
        // If refreshing fails, the refresh token is likely invalid.
        // Clear tokens and redirect to login.
        console.error("Refresh token failed:", refreshError);
        localStorage.removeItem('accessToken');
        localStorage.removeItem('refreshToken');
        processQueue(refreshError, null);
        
        // Example: Router.push('/login');
        return Promise.reject(refreshError);
      } finally {
        isRefreshing = false;
      }
    }
    
    return Promise.reject(error);
  }
);

export default apiClient;


‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./lib/auth.ts
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

import jwt from 'jsonwebtoken';
import prisma from './prisma';
import type { User } from '@prisma/client';

export interface AuthResult {
  user: User;
  payload: any;
}

/**
 * Extract and verify the access token from the request Authorization header.
 * Returns the user and token payload or null if unauthorized.
 */
export async function getAuthUserFromRequest(req: Request): Promise<AuthResult | null> {
  const authHeader = req.headers.get('authorization') || req.headers.get('Authorization');
  if (!authHeader || !authHeader.startsWith('Bearer ')) return null;

  const token = authHeader.split(' ')[1];
  try {
    const payload = jwt.verify(token, process.env.JWT_ACCESS_SECRET as string) as any;
    if (!payload || !payload.userId) return null;

    const user = await prisma.user.findUnique({ where: { id: payload.userId } });
    if (!user) return null;

    return { user, payload };
  } catch (err) {
    return null;
  }
}

export default getAuthUserFromRequest;


‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./lib/fonts.ts
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

// FILE: lib/fonts.ts
import localFont from "next/font/local";

// Configure the Yekan Bakh font
export const Yekan = localFont({
  src: [
    {
      path: '/../public/fonts/Yekan.ttf',
      weight: '700',
      style: 'bold',
    }
  ],
  variable: '--font-yekan', // A CSS variable to use the font
});

// BYekan is a variable font, so you can use it in your CSS like this:
export const BYekan = localFont({
  src: [
    {
      path: '/../public/fonts/BYekan.ttf',
      weight: '700',
      style: 'bolder',
    }
  ],
  variable: '--font-yekan-bakh', // A CSS variable to use the font
});

// Parastoo is a variable font, so you can use it in your CSS like this:
export const Samim = localFont({
  src: [
    {
      path: '/../public/fonts/Samim.ttf',
      weight: '400',
      style: 'normal',
    },
    {
      path: '/../public/fonts/Samim-Bold.ttf',
      weight: '800',
      style: 'bold',
    }
  ],
  variable: '--font-samim', // A CSS variable to use the font
});


‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./lib/prisma.ts
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

// FILE: lib/prisma.ts (Please ensure this is the exact content)
import { PrismaClient } from '@prisma/client'

const prismaClientSingleton = () => {
  return new PrismaClient()
}

declare global {
  var prisma: undefined | ReturnType<typeof prismaClientSingleton>
}

const prisma = globalThis.prisma ?? prismaClientSingleton()

export default prisma

if (process.env.NODE_ENV !== 'production') globalThis.prisma = prisma


‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./lib/session.ts
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

// DEPRECATED: `lib/session.ts` was replaced by `lib/auth.ts`.
// Keep this file as a shim to avoid import errors while migrating.
// Please update imports to use `getAuthUserFromRequest` from `@/lib/auth`.

export function _deprecated_session_shim() {
  throw new Error('lib/session.ts is deprecated; use lib/auth.ts -> getAuthUserFromRequest(req)');
}



‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./lib/utils.ts
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

import { clsx, type ClassValue } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}



‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./middleware.ts
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

// FILE: client/middleware.ts
// DESCRIPTION: Intercepts incoming requests to protected API routes to validate JWT access tokens.

import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';
import { jwtVerify } from 'jose'; // A modern, secure library for JWT handling

/**
 * This middleware function is triggered for all routes matching the `matcher` config.
 * It checks for a valid JWT in the 'Authorization' header.
 *
 * @param {NextRequest} request - The incoming request object.
 * @returns {NextResponse} The response to send back, either continuing the chain or denying access.
 */
export async function middleware(request: NextRequest) {
  // 1. Extract the token from the Authorization header (e.g., "Bearer eyJhbGci...")
  const authHeader = request.headers.get('authorization');
  const token = authHeader?.split(' ')[1];

  // 2. If no token is found, return an 'Unauthorized' error
  if (!token) {
    return new NextResponse(
      JSON.stringify({ success: false, message: 'Authentication failed: No token provided.' }),
      { status: 401, headers: { 'content-type': 'application/json' } }
    );
  }

  try {
    // 3. Get the secret key from environment variables
    const secret = new TextEncoder().encode(process.env.JWT_ACCESS_SECRET!);

    // 4. Verify the token. If it's invalid or expired, jwtVerify will throw an error.
    // We don't need the payload here, just the verification check.
    await jwtVerify(token, secret);

    // 5. If the token is valid, allow the request to proceed to the API route
    return NextResponse.next();

  } catch (err) {
    console.error("JWT Verification Error:", err);
    // 6. If verification fails, return a 'Forbidden' error
    return new NextResponse(
      JSON.stringify({ success: false, message: 'Authentication failed: Invalid token.' }),
      { status: 403, headers: { 'content-type': 'application/json' } }
    );
  }
}

// --- Configuration ---
/**
 * The `matcher` config specifies which routes this middleware should run on.
 * We are protecting all API routes under /api/user, /api/orders, etc.,
 * while excluding the public authentication routes.
 *
 * It uses a negative lookahead `(?!...)` to exclude specific paths.
 */
export const config = {
  matcher: [
    '/api/((?!auth|products|categories).*)', // Protects all API routes except auth, products, and categories
    '/api/user/:path*',
    '/api/orders/:path*',
    '/api/admin/:path*',
  ],
};


‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./next-env.d.ts
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

/// <reference types="next" />
/// <reference types="next/image-types/global" />

// NOTE: This file should not be edited
// see https://nextjs.org/docs/app/api-reference/config/typescript for more information.



‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./prisma/schema.prisma
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Generator block specifies the Prisma Client generator to be used.
generator client {
  provider = "prisma-client-js"
}

// Datasource block specifies the database connection.
datasource db {
  provider = "postgresql" // Using PostgreSQL database.
  url      = env("DATABASE_URL") // Connection URL is loaded from .env file.
}

// Model for product suppliers (e.g., Kalleh, Mihan).
model Supplier {
  id       String    @id @default(cuid()) // Unique ID for the supplier.
  name     String    @unique // Name of the supplier, must be unique.
  logo     String?   // Optional URL for the supplier's logo.
  products Product[] // Relation to all products from this supplier.
}

// Model for product distributors (e.g., Alghadir Distribution).
model Distributor {
  id       String    @id @default(cuid()) // Unique ID for the distributor.
  name     String    @unique // Name of the distributor, must be unique.
  logo     String?   // Optional URL for the distributor's logo.
  products Product[] // Relation to all products handled by this distributor.
}

// Model for settlement types (e.g., Cash, 1-month check).
model Settlement {
  id          String  @id @default(cuid()) // Unique ID for the settlement type.
  name        String  @unique // Name of the settlement type, must be unique.
  description String? // Optional description.
  orders      Order[] // Relation to all orders using this settlement type.
}

// Model for product categories (e.g., Dairy, Beverages).
model Category {
  id       String    @id @default(cuid()) // Unique ID for the category.
  name     String    @unique // Name of the category, must be unique.
  icon     String?   // Optional emoji/icon for the category.
  image    String?   // Optional URL for the category's image.
  products Product[] // Relation to all products in this category.
}

// Main model for products.
model Product {
  id                 String      @id @default(cuid()) // Unique ID for the product.
  name               String      // Name of the product.
  description        String?     // Optional description.
  price              Float       // Sale price.
  consumerPrice      Float?      // Optional consumer price.
  image              String?     // Optional URL for the product's image.
  available          Boolean     @default(true) // Availability status.
  discountPercentage Int         @default(0) // Discount percentage.
  unit               String      @default("ÿπÿØÿØ") // Unit of measurement (e.g., "carton", "bottle").
  stock              Int         @default(0) // Current stock quantity.
  isFeatured         Boolean     @default(false) // Flag for featured products.
  createdAt          DateTime    @default(now()) // Timestamp of creation.
  updatedAt          DateTime    @default(now()) @updatedAt // Timestamp of last update.

  // Relations
  categoryId         String      // Foreign key for Category.
  category           Category    @relation(fields: [categoryId], references: [id])
  supplierId         String      // Foreign key for Supplier.
  supplier           Supplier    @relation(fields: [supplierId], references: [id])
  distributorId      String      // Foreign key for Distributor.
  distributor        Distributor @relation(fields: [distributorId], references: [id])
  orderItems         OrderItem[] // Relation to order items (added for procurement fix).

  // A product is unique based on its name and supplier.
  @@unique([name, supplierId])
}

// Model for customer orders.
model Order {
  id            String         @id @default(cuid()) // Unique ID for the order.
  totalPrice    Float          // Total price of the order.
  deliveryDate  DateTime       // Scheduled delivery date.
  status        OrderStatus    @default(PENDING) // Current status of the order.
  notes         String?        // Optional notes from the customer.
  createdAt     DateTime       @default(now()) // Timestamp of creation.
  
  // Relations
  userId        String         // Foreign key for User.
  user          User           @relation(fields: [userId], references: [id])
  settlementId  String         // Foreign key for Settlement.
  settlement    Settlement     @relation(fields: [settlementId], references: [id])
  items         OrderItem[]    // List of items in this order.
  returnRequest ReturnRequest? // Optional relation to a return request.
}

// Model for items within an order.
model OrderItem {
  id          String  @id @default(cuid()) // Unique ID for the order item.
  productName String  // Name of the product at the time of order.
  quantity    Int     // Quantity ordered.
  price       Float   // Price per unit at the time of order.

  // Relations
  orderId     String  // Foreign key for Order.
  order       Order   @relation(fields: [orderId], references: [id])
  
  // --- FIX for Procurement Logic ---
  productId   String  // Foreign key for Product. This is crucial for accurate tracking.
  product     Product @relation(fields: [productId], references: [id], onDelete: Cascade)
  
  returnRequestItems ReturnRequestItem[] // Relation to items in a return request.
}

// Model for users (customers, admins, workers).
model User {
  id          String   @id @default(cuid()) // Unique ID for the user.
  phone       String   @unique // User's phone number, must be unique.
  password    String   // Hashed password.
  name        String?  // User's full name.
  shopName    String?  // User's shop name.
  shopAddress String?  // User's shop address.
  landline    String?  // Optional landline phone number.
  latitude    Float?   // Optional geographic latitude.
  longitude   Float?   // Optional geographic longitude.
  role        Role     @default(CUSTOMER) // User's role (determines permissions).
  createdAt   DateTime @default(now()) // Timestamp of creation.
  
  // Relations
  orders      Order[]  // List of all orders placed by this user.
}

// Model for return requests.
model ReturnRequest {
  id        String       @id @default(cuid()) // Unique ID for the return request.
  status    ReturnStatus @default(REQUESTED) // Current status of the return request.
  reason    String?      // Optional reason for the return.
  createdAt DateTime     @default(now()) // Timestamp of creation.

  // Relations
  orderId   String       @unique // Foreign key to the Order, one-to-one relation.
  order     Order        @relation(fields: [orderId], references: [id])
  items     ReturnRequestItem[] // List of items being returned.
}

// Model for items within a return request.
model ReturnRequestItem {
  id              String        @id @default(cuid()) // Unique ID.
  quantity        Int           // Quantity to be returned.

  // Relations
  orderItemId     String        // Foreign key to the original OrderItem.
  orderItem       OrderItem     @relation(fields: [orderItemId], references: [id])
  returnRequestId String        // Foreign key to the ReturnRequest.
  returnRequest   ReturnRequest @relation(fields: [returnRequestId], references: [id])
}

// Enum for possible order statuses.
enum OrderStatus {
  PENDING   // Order placed, awaiting confirmation.
  SHIPPED   // Order is out for delivery.
  DELIVERED // Order has been delivered.
  CANCELED  // Order has been canceled.
}

// Enum for user roles.
enum Role {
  CUSTOMER // Standard user.
  ADMIN    // Administrator with full access.
  WORKER   // Delivery personnel.
}

// Enum for possible return request statuses.
enum ReturnStatus {
  REQUESTED // Return has been requested by the customer.
  APPROVED  // Return has been approved by an admin/worker.
  REJECTED  // Return has been rejected.
}




‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./prisma/seed.ts
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

// FILE: prisma/seed.ts
// Final Version: This script cleans the database and seeds it with fresh, structured data,
// including sample orders for a more realistic development environment.

import { PrismaClient, Role } from '@prisma/client';

const prisma = new PrismaClient();

async function main() {
  console.log(`üå± Start seeding ...`);

  // --- 1. Deleting all existing data in the correct order ---
  console.log("üî• Deleting existing data to prevent conflicts...");
  await prisma.returnRequestItem.deleteMany({});
  await prisma.returnRequest.deleteMany({});
  await prisma.orderItem.deleteMany({});
  await prisma.order.deleteMany({});
  await prisma.product.deleteMany({});
  await prisma.category.deleteMany({});
  await prisma.settlement.deleteMany({});
  await prisma.supplier.deleteMany({});
  await prisma.distributor.deleteMany({});
  await prisma.user.deleteMany({});
  console.log("‚úÖ All previous data deleted successfully.");

  // --- 2. Seeding Categories, Suppliers, and Distributors ---
  console.log("üè≠ Seeding core business models...");
  const categories = await prisma.category.createManyAndReturn({
    data: [
      { name: "ÿ≥Ÿàÿ≥€åÿ≥ Ÿà ⁄©ÿßŸÑÿ®ÿßÿ≥", icon: "üå≠" },
      { name: "ŸÑÿ®ŸÜ€åÿßÿ™", icon: "üßÄ" },
      { name: "ÿ™ÿÆŸÖ ŸÖÿ±ÿ∫", icon: "ü•ö" },
      { name: "ŸÜŸàÿ¥€åÿØŸÜ€å", icon: "ü•§" },
    ],
  });
  const categoryMap = new Map(categories.map(c => [c.name, c.id]));

  const suppliers = await prisma.supplier.createManyAndReturn({
    data: [
      { name: "⁄©ÿßŸÑŸá", logo: "https://www.kalleh.com/template/img/logo.png" },
      { name: "ŸÖ€åŸáŸÜ", logo: "https://www.mihan-food.com/images/logo-fa.png" },
      { name: "ÿ≥€åŸÖÿ±ÿ∫", logo: "https://simorgh.com/wp-content/uploads/2020/06/logo.png" },
      { name: "ÿ¢ŸÜÿØÿ±Ÿá", logo: "https://andre.ir/wp-content/uploads/2021/01/logo-andre.png" },
      { name: "Ÿæ⁄ØÿßŸá", logo: "https://pegah.ir/wp-content/uploads/2019/07/logo-pegah.png" },
    ],
  });
  const supplierMap = new Map(suppliers.map(s => [s.name, s.id]));

  const distributors = await prisma.distributor.createManyAndReturn({
    data: [
      { name: "ŸæÿÆÿ¥ ÿßŸÑÿ∫ÿØ€åÿ±" },
      { name: "ŸæÿÆÿ¥ ŸÖÿ±⁄©ÿ≤€å" },
      { name: "ŸæÿÆÿ¥ ÿßŸÑÿ®ÿ±ÿ≤" },
    ],
  });
  const distributorMap = new Map(distributors.map(d => [d.name, d.id]));
  console.log("‚úÖ Categories, Suppliers, and Distributors seeded.");

  // --- 3. Seeding Products ---
  console.log("üì¶ Seeding products...");
  const products = await prisma.product.createManyAndReturn({
    data: [
      {
        name: "Ÿáÿßÿ™ ÿØÿß⁄Ø ŸæŸÜ€åÿ±€å ÿ¢ŸÜÿØÿ±Ÿá", price: 1500000,
        image: "https://api.snapp.market/media/cache/product-image/1687259469_247343_1_260x260.jpg",
        categoryId: categoryMap.get("ÿ≥Ÿàÿ≥€åÿ≥ Ÿà ⁄©ÿßŸÑÿ®ÿßÿ≥")!,
        supplierId: supplierMap.get("ÿ¢ŸÜÿØÿ±Ÿá")!,
        distributorId: distributorMap.get("ŸæÿÆÿ¥ ŸÖÿ±⁄©ÿ≤€å")!,
        stock: 100, unit: "ÿ®ÿ≥ÿ™Ÿá"
      },
      {
        name: "⁄©ÿßŸÑÿ®ÿßÿ≥ ÿÆÿ¥⁄© ⁄©ÿßŸÑŸá", price: 2200000,
        image: "https://api.snapp.market/media/cache/product-image/1608722744_419208_1_260x260.jpg",
        categoryId: categoryMap.get("ÿ≥Ÿàÿ≥€åÿ≥ Ÿà ⁄©ÿßŸÑÿ®ÿßÿ≥")!,
        supplierId: supplierMap.get("⁄©ÿßŸÑŸá")!,
        distributorId: distributorMap.get("ŸæÿÆÿ¥ ÿßŸÑÿ®ÿ±ÿ≤")!,
        stock: 50, unit: "⁄©€åŸÑŸà⁄Øÿ±ŸÖ"
      },
      {
        name: "ÿ™ÿÆŸÖ ŸÖÿ±ÿ∫ €≤€∞ ÿπÿØÿØ€å ÿ≥€åŸÖÿ±ÿ∫", price: 980000,
        image: "https://api.snapp.market/media/cache/product-image/1608722744_419208_1_260x260.jpg",
        categoryId: categoryMap.get("ÿ™ÿÆŸÖ ŸÖÿ±ÿ∫")!,
        supplierId: supplierMap.get("ÿ≥€åŸÖÿ±ÿ∫")!,
        distributorId: distributorMap.get("ŸæÿÆÿ¥ ÿßŸÑÿ∫ÿØ€åÿ±")!,
        stock: 200, unit: "ÿ®ÿ≥ÿ™Ÿá", discountPercentage: 10
      },
      {
        name: "ŸæŸÜ€åÿ± Ÿæ€åÿ™ÿ≤ÿß ŸÖŸàÿ≤ÿßÿ±ŸÑÿß ⁄©ÿßŸÑŸá", price: 2100000,
        image: "https://img.beroozmart.com/unsafe/files/shop/product/661c44bfac8045bfb5fcfe380213a0a9.jpg",
        categoryId: categoryMap.get("ŸÑÿ®ŸÜ€åÿßÿ™")!,
        supplierId: supplierMap.get("⁄©ÿßŸÑŸá")!,
        distributorId: distributorMap.get("ŸæÿÆÿ¥ ŸÖÿ±⁄©ÿ≤€å")!,
        stock: 80, unit: "⁄©€åŸÑŸà⁄Øÿ±ŸÖ"
      },
      {
        name: "ÿ¥€åÿ± ⁄©ŸÖ ⁄Üÿ±ÿ® €± ŸÑ€åÿ™ÿ±€å ŸÖ€åŸáŸÜ", price: 450000,
        image: "https://api.snapp.market/media/cache/product-image/1687259469_247343_1_260x260.jpg",
        categoryId: categoryMap.get("ŸÑÿ®ŸÜ€åÿßÿ™")!,
        supplierId: supplierMap.get("ŸÖ€åŸáŸÜ")!,
        distributorId: distributorMap.get("ŸæÿÆÿ¥ ÿßŸÑÿ∫ÿØ€åÿ±")!,
        stock: 150, unit: "ÿπÿØÿØ"
      },
    ]
  });
  const productMap = new Map(products.map(p => [p.name, p]));
  console.log("‚úÖ Products seeded.");

  // --- 4. Seeding Users and Settlements ---
  console.log("üë§ Seeding users and settlements...");
  const settlements = await prisma.settlement.createManyAndReturn({
    data: [{ name: "ŸÜŸÇÿØ€å" }, { name: "⁄Ü⁄© €± ŸÖÿßŸáŸá" }],
  });
  const cashSettlementId = settlements.find(s => s.name === "ŸÜŸÇÿØ€å")!.id;

  const hashedPassword = '$2b$10$e9UmfvfnSvtRxly0dqFlVegEyQ50uQ4tZxLGycXRbYstFpH6V83Cm'; // "password"
  const customer = await prisma.user.create({
    data: {
      phone: '09120000000',
      password: hashedPassword,
      name: 'ŸÖÿ¥ÿ™ÿ±€å ÿ™ÿ≥ÿ™€å',
      shopName: 'ŸÅÿ±Ÿàÿ¥⁄ØÿßŸá ŸÜŸÖŸàŸÜŸá',
      role: 'CUSTOMER'
    }
  });
  await prisma.user.createMany({
    data: [
      { phone: '09130027927', password: hashedPassword, name: 'ÿ≠ŸÖ€åÿØÿ±ÿ∂ÿß ÿ∫ŸÜ€å ŸÜÿ≥ÿ®', role: 'ADMIN' },
      { phone: '09100000000', password: hashedPassword, name: 'Ÿæ€å⁄© ŸÜŸÖŸàŸÜŸá', role: 'WORKER' },
    ]
  });
  console.log("‚úÖ Users and settlements seeded.");

  // --- 5. Seeding Sample Orders ---
  console.log("üõí Seeding sample orders...");
  const hotdog = productMap.get("Ÿáÿßÿ™ ÿØÿß⁄Ø ŸæŸÜ€åÿ±€å ÿ¢ŸÜÿØÿ±Ÿá")!;
  const milk = productMap.get("ÿ¥€åÿ± ⁄©ŸÖ ⁄Üÿ±ÿ® €± ŸÑ€åÿ™ÿ±€å ŸÖ€åŸáŸÜ")!;
  const egg = productMap.get("ÿ™ÿÆŸÖ ŸÖÿ±ÿ∫ €≤€∞ ÿπÿØÿØ€å ÿ≥€åŸÖÿ±ÿ∫")!;

  // Order 1: Pending
  await prisma.order.create({
    data: {
      userId: customer.id,
      settlementId: cashSettlementId,
      deliveryDate: new Date(Date.now() + 3 * 24 * 60 * 60 * 1000), // 3 days from now
      status: 'PENDING',
      totalPrice: (hotdog.price * 2) + milk.price,
      items: {
        create: [
          { productName: hotdog.name, quantity: 2, price: hotdog.price },
          { productName: milk.name, quantity: 1, price: milk.price },
        ]
      }
    }
  });

  // Order 2: Delivered
  const eggPriceWithDiscount = egg.price * (1 - egg.discountPercentage / 100);
  await prisma.order.create({
    data: {
      userId: customer.id,
      settlementId: cashSettlementId,
      deliveryDate: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000), // 5 days ago
      status: 'DELIVERED',
      totalPrice: eggPriceWithDiscount * 5,
      items: {
        create: [
          { productName: egg.name, quantity: 5, price: eggPriceWithDiscount },
        ]
      }
    }
  });
  console.log("‚úÖ Sample orders seeded.");

  console.log(`\nüéâ Seeding finished successfully!`);
}

main()
  .catch((e) => {
    console.error("‚ùå An error occurred during seeding:");
    console.error(e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });


‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./types/index.ts
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

// FILE: types/index.ts (FIXED)
import type {
  Order as PrismaOrder,
  OrderItem as PrismaOrderItem,
  Product as PrismaProduct,
  Category as PrismaCategory,
  User as PrismaUser,
  Settlement as PrismaSettlement,
  ReturnRequest as PrismaReturnRequest,
  ReturnRequestItem as PrismaReturnRequestItem,
  Supplier as PrismaSupplier,
  Distributor as PrismaDistributor
} from '@prisma/client';

export type CartItem = PrismaProduct & {
  quantity: number;
};

// An order with its associated items included
export type OrderWithItems = PrismaOrder & {
  items: PrismaOrderItem[];
  total: number;
};

// An order with its associated items and the customer's info
export type OrderWithItemsAndUser = PrismaOrder & {
  items: PrismaOrderItem[];
  user: {
      name: string | null;
      shopName: string | null;
  };
};

// A full return request, including its items and the related order details
export type FullReturnRequest = PrismaReturnRequest & {
  items: (PrismaReturnRequestItem & {
    orderItem: PrismaOrderItem;
  })[];
  order: OrderWithItems;
};

// Exporting all Prisma types for easy access across the app
export type {
  PrismaProduct as Product,
  PrismaCategory as Category,
  PrismaUser as User,
  PrismaSettlement as Settlement,
  PrismaReturnRequest as ReturnRequest,
  PrismaReturnRequestItem as ReturnRequestItem,
  PrismaSupplier as Supplier,
  PrismaDistributor as Distributor
}


‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
üìÅ File: ./utils/persianNum.ts
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

const toPersianDigits = (num: number) => {
    const persian = {
      0: "€∞", 1: "€±", 2: "€≤", 3: "€≥", 4: "€¥", 5: "€µ", 6: "€∂", 7: "€∑", 8: "€∏", 9: "€π"
    };
    // Format with thousands separator if >= 1000
    const formatted = num >= 1000 ? num.toLocaleString("en-US") : num.toString();
    return formatted.replace(/\d/g, (d) => persian[d as unknown as keyof typeof persian]);
};

export default toPersianDigits;

